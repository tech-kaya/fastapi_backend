version: 1.0
runtime: docker
build:
  commands:
    build:
      - echo "Using pre-built ECR image"
      - aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 164695193236.dkr.ecr.us-east-1.amazonaws.com
      - docker pull 164695193236.dkr.ecr.us-east-1.amazonaws.com/backend-kaya:latest
      - docker tag 164695193236.dkr.ecr.us-east-1.amazonaws.com/backend-kaya:latest fastapi-app
run:
  command: uvicorn app.main:app --host 0.0.0.0 --port 8000
  network:
    port: 8000
  env:
    POSTGRES_DB: postgres
    POSTGRES_USER: postgress
    POSTGRES_PASSWORD: Postgress123
    POSTGRES_HOST: postgress.clw6ay8win72.eu-north-1.rds.amazonaws.com
    POSTGRES_PORT: "5432"
    BROWSER_USE_API_KEY: bu_TLSzMVl-qSa84ryRq9VNpISkkuUHksifVBN3fklX8lw
    LOG_LEVEL: INFO
    MAX_AGENT_STEPS: "50"
    FORM_TIMEOUT: "300"
    HEADLESS: "true"
    SHOW_AGENT_STEPS: "false"
